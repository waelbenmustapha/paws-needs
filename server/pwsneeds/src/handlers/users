const connectDatabase = require("../database/db");
const User = require("../models/user");
const bcrypt = require("bcryptjs");
module.exports.getAll = async (event, context) => {
  context.callbackWaitsForEmptyEventLoop = false;

  try {
    await connectDatabase();

    const users = await User.find({});

    return {
      statusCode: 201,
      body: JSON.stringify(users),
    };
  } catch (error) {
    console.log(error);
    return {
      statusCode: error.statusCode || 500,
      body: JSON.stringify({ error: error.message }),
    };
  }
};

module.exports.getByEmail = async (event, context) => {
  context.callbackWaitsForEmptyEventLoop = false;
  try {
    await connectDatabase();
    const { email } = event.pathParameters;
    console.log(email)
    const users = await User.findOne({ email });
    console.log(users)

    return {
      statusCode: 201,
      body: JSON.stringify(users),
    };
  } catch (error) {
    console.log(error);
    return {
      statusCode: error.statusCode || 500,
      body: JSON.stringify({ error: error.message }),
    };
  }
};
